============================================================
STEP 4b: EVALUATE TRAINED POSTERIOR
============================================================

1. Loading validation data...
   Validation set size: 107
   theta_val shape: (107, 2)
   x_val shape: torch.Size([107, 2762])

2. Loading trained posterior...
   Loaded from: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/posterior_snpe.pt

3. Sampling from posterior on validation set...
   Drawing 500 samples per observation...
   Processed 20/107
   Processed 40/107
   Processed 60/107
   Processed 80/107
   Processed 100/107

   Posterior means shape: (107, 2)
   Posterior stds shape: (107, 2)

4. Computing evaluation metrics...

============================================================
EVALUATION RESULTS
============================================================

xHI (Neutral Fraction) Metrics:
  R² Score: 0.3576 (ideal: 1.0, bad: <0.5)
  RMSE: 0.235893 (lower is better)
  Z-score mean: 0.0313 (ideal: 0.0)
  Z-score std:  0.9808 (ideal: 1.0)

fX (log10 X-ray heating) Metrics:
  R² Score: 0.7403 (ideal: 1.0, bad: <0.5)
  RMSE: 0.763497 (lower is better)
  Z-score mean: -0.2069 (ideal: 0.0)
  Z-score std:  1.0029 (ideal: 1.0)

============================================================
TRAINING QUALITY ASSESSMENT
============================================================

⚠️  R² Scores: FAIR (>0.3)

✅ Z-score means: REASONABLE

✅ Z-score std: CALIBRATED (close to 1)

============================================================
✅ OVERALL: TRAINING IS ACCEPTABLE. Proceed cautiously
============================================================

5. Creating evaluation plots...
   Plot saved to: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/evaluation_metrics.png
   Metrics saved to: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/evaluation_metrics.pkl

============================================================
✅ EVALUATION COMPLETE!
============================================================

==========================================
Step 4: Train SNPE
==========================================
Host: compute-1-4
OMP_NUM_THREADS = 32
CWD: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h
Python: /user1/supriyo/miniconda3/envs/ml_project/bin/python
Conda env: ml_project           * /user1/supriyo/miniconda3/envs/ml_project
==========================================
Using device: cpu

============================================================
STEP 4: TRAIN SNPE (Neural Posterior Estimation)
============================================================

1. Loading split dataset...
   theta_train shape: torch.Size([427, 2])
   x_train shape: torch.Size([427, 2762])
   theta_val shape: torch.Size([107, 2])
   x_val shape: torch.Size([107, 2762])

   Dataset summary:
   - Training samples: 427
   - Validation samples: 107
   - Input dimension (frequencies): 2762
   - Parameter dimension: 2 (xHI, fX)

2. Defining prior...
   Prior: xHI ∈ [0, 1], fX ∈ [-4, 1]

3. Initializing SNPE...

4. Training with hyperparameters:
   batch_size: 16
   learning_rate: 0.0001
   num_epochs: 100

5. Training neural posterior...
   This may take 10-30 minutes on CPU...
 Training neural network. Epochs trained: 1 Training neural network. Epochs trained: 2 Training neural network. Epochs trained: 3 Training neural network. Epochs trained: 4 Training neural network. Epochs trained: 5 Training neural network. Epochs trained: 6 Training neural network. Epochs trained: 7 Training neural network. Epochs trained: 8 Training neural network. Epochs trained: 9 Training neural network. Epochs trained: 10 Training neural network. Epochs trained: 11 Training neural network. Epochs trained: 12 Training neural network. Epochs trained: 13 Training neural network. Epochs trained: 14 Training neural network. Epochs trained: 15 Training neural network. Epochs trained: 16 Training neural network. Epochs trained: 17 Training neural network. Epochs trained: 18 Training neural network. Epochs trained: 19 Training neural network. Epochs trained: 20 Training neural network. Epochs trained: 21 Training neural network. Epochs trained: 22 Training neural network. Epochs trained: 23 Training neural network. Epochs trained: 24 Training neural network. Epochs trained: 25 Training neural network. Epochs trained: 26 Training neural network. Epochs trained: 27 Training neural network. Epochs trained: 28 Training neural network. Epochs trained: 29 Training neural network. Epochs trained: 30 Training neural network. Epochs trained: 31 Training neural network. Epochs trained: 32 Training neural network. Epochs trained: 33 Training neural network. Epochs trained: 34 Training neural network. Epochs trained: 35 Training neural network. Epochs trained: 36 Training neural network. Epochs trained: 37 Training neural network. Epochs trained: 38 Training neural network. Epochs trained: 39 Training neural network. Epochs trained: 40 Training neural network. Epochs trained: 41 Training neural network. Epochs trained: 42 Training neural network. Epochs trained: 43 Training neural network. Epochs trained: 44 Training neural network. Epochs trained: 45 Training neural network. Epochs trained: 46 Training neural network. Epochs trained: 47 Training neural network. Epochs trained: 48 Training neural network. Epochs trained: 49 Training neural network. Epochs trained: 50 Training neural network. Epochs trained: 51 Training neural network. Epochs trained: 52 Training neural network. Epochs trained: 53 Training neural network. Epochs trained: 54 Training neural network. Epochs trained: 55 Training neural network. Epochs trained: 56 Training neural network. Epochs trained: 57 Training neural network. Epochs trained: 58 Training neural network. Epochs trained: 59 Neural network successfully converged after 59 epochs.
        -------------------------
        ||||| ROUND 1 STATS |||||:
        -------------------------
        Epochs trained: 59
        Best validation performance: -0.7334
        -------------------------
        

✅ Training complete!

6. Saving posterior...
   Saved to: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/posterior_snpe.pt
   Metadata saved to: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/metadata_train.pkl

============================================================
✅ STEP 4 COMPLETE!
============================================================

Training Summary:
  - Trained on: 427 samples
  - Validated on: 107 samples
  - Model saved: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/posterior_snpe.pt

Next: Run Step 5 for posterior inference on 5 test points

✅ Log saved to: /user1/supriyo/ml_project/SBI_step_by_step/UGMRT_500h/Outputs/training_log.txt
